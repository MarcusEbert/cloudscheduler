

{% block navbar %}
   {% include "csv2/navigation_bar.html" %}
{% endblock %}

<head>
{% load template_utils %}
{% load static %}
<!--<link rel="stylesheet" type="text/css" href="{% static "csv2/styles.css" %}">-->
<link rel="stylesheet" type="text/css" href="{% static "csv2/groups.css" %}">

<script type="text/javascript">
    function show_group(group_name){
        if (group_name.length > 0) {
            document.location.hash = group_name;
        }
    }
</script>

</head>

<body class="groups-nav" onpageshow="show_group('{{current_group}}')">
<!--https://www.w3.org/Style/Examples/007/target.en.html#tab1-->
<div class="main-div">
    <div class="menu">
    {% for group in group_list %}
        <div id="{{group.group_name}}"> <a href="#{{group.group_name}}">{{group.group_name}}</a>
            
            <div>
                <form name="{{group.group_name}}" action="/group/update/" method="post">
                    {% csrf_token %}
                    <table>
                        <input type="hidden" name="group_name" value="{{group.group_name}}" />

                        <tr class="highlight1"><td><label for="condor_central_manager">Condor Central Manager</label></td>
                        <td><input type="text" name="condor_central_manager" id="" value="{{group.condor_central_manager}}" /></td></tr>

                        <tr class="highlight2"><td><label for="user_groups">Users</label></td><td></td></tr>

                        {% for user in groups_per_user %}
                            {{ user.group_name }}
                            {% if group.group_name in user.user_groups %}

                                <tr><td></td><td class="highlight2"><input type="checkbox" name="username.{{ forloop.counter }}" value="{{ user.username }}" checked/> {{ user.username }}</td></tr>
                            {% else %}
                                <tr><td></td><td class="highlight2"><input type="checkbox" name="username.{{ forloop.counter }}" value="{{ user.username }}" /> {{ user.username }}</td></tr>
                            {% endif %}
                        {% endfor %}

                        <tr><td><input type="submit" value="Update Group" /></td>
                        <td><a href="#delete-{{group.group_name}}"><button type="button">Delete</button></a></td></tr>
                    </table>
                </form>
            </div>

        </div>
    {% endfor %}
        <div id="add-group"> <a href="#add-group">+</a>
            <div>
                <form name="add_group" action="/group/add/" method="post">
                    {% csrf_token %}
                    <table>
                        <tr class="highlight1"><td><label for="group_name">Group name</label></td>
                        <td><input type="text" name="group_name" id="" value="" /></td></tr>

                        <tr class="highlight1"><td><label for="condor_central_manager">Condor Central Manager</label></td>
                        <td><input type="text" name="condor_central_manager" id="" value="" /></td></tr>

                        <!--
                        <tr><td><label for="group_yaml">Group yaml</label></td>
                        <td><textarea name="group_yaml" rows="10" cols="30">Enter yaml here</textarea></td></tr>
                        -->

                        <tr class="highlight2"><td><label for="user_groups">Users</label></td><td></td></tr>
                        {% for user in groups_per_user %}
                            {{ user.group_name }}
                                <tr><td></td><td class="highlight2"><input type="checkbox" name="username.{{ forloop.counter }}" value="{{ user.username }}" /> {{ user.username }}</td></tr>
                        {% endfor %}

                        <tr><td><input type="submit" value="Add Group" /></td></tr>

                    </table>
                </form>
            </div>
        </div>
    </div>


    {% for group in group_list %}
    <div id="delete-{{group.group_name}}" class="modalDialog">
        <div>
            <a href="#{{group.group_name}}" title="Close" class="close">X</a>
            <form name="{{group.group_name}}" action="/group/delete/" method="post">
                {% csrf_token %}
                <input type="hidden" name="group_name" id="" value="{{group.group_name}}" />
                <input type="submit" value="Delete {{group.group_name}}" />
            </form>
        </div>
    </div>
    {% endfor %}

</div>

<div class="footer"
    {% if response_code == 1 %}
        <tr><td><b>Error: {{ message }}</b></td></tr>
    {% elif message is not None %}
        <tr><td>{{ message }}</td></tr>
    {% endif %}
</div>


</body>

