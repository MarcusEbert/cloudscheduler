

{% block navbar %}
   {% include "csv2/navigation_bar.html" %}
{% endblock %}

<head>
    {% load template_utils %}
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static "csv2/common.css" %}">
    <link rel="stylesheet" type="text/css" href="{% static "csv2/groups.css" %}">

    <script type="text/javascript" src="{% static "csv2/common.js" %}"></script>



</head>

<body class="groups-nav" onpageshow="show_group('{{current_group}}')">
<!--https://www.w3.org/Style/Examples/007/target.en.html#tab1-->
<div class="main-div">
    <div class="menu">
    <!--https://codepen.io/nathanlong/pen/mBrvn-->
    {% for group in group_list %}
        <div id="{{group.group_name}}"> <a href="#{{group.group_name}}">{{group.group_name}}</a>
            
            <div class="menu-target">
                <form name="{{group.group_name}}" action="/group/update/" method="post">
                    {% csrf_token %}

                    <input type="hidden" name="group_name" value="{{group.group_name}}" />
                    <table>
                        <tr class="highlight1"><td><label for="condor_central_manager">Condor Central Manager</label></td>
                        <td><input type="text" name="condor_central_manager" id="" value="{{group.condor_central_manager}}" /></td></tr>
                        
                        <tr class="highlight2"><td><label for="user_groups">Users</label></td>
                        <td><input id="search-{{ group.group_name }}" type="text" placeholder="User search.." onkeyup="search('{{group.group_name}}')"></td></tr>
                        <!--https://www.w3schools.com/howto/howto_js_filter_lists.asp-->

                        <tr><td></td><td class="highlight2">
                        <div class="user-list">
                        <ul id="ul-{{ group.group_name }}">
                        {% for user in groups_per_user %}
                            {{ user.group_name }}
                            {% if group.group_name in user.user_groups %}
                                <li><input type="checkbox" name="username.{{ forloop.counter }}" value="{{ user.username }}" checked/>{{ user.username }}</input></li>
                            {% else %}
                                <li><input type="checkbox" name="username.{{ forloop.counter }}" value="{{ user.username }}" />{{user.username }}</input></li>
                            {% endif %}
                        {% endfor %}
                        </ul>
                        </div>
                        </td></tr>
                    </table>

                    <input type="submit" value="Update Group" />
                    <a href="#delete-{{group.group_name}}"><button type="button">Delete</button></a>

                </form>
            </div>

        </div>

    {% endfor %}
        <div id="add-group"> <a href="#add-group">+</a>
            <div class="menu-target">
                <form name="add_group" action="/group/add/" method="post">
                    {% csrf_token %}
                    <table>
                        <tr class="highlight1"><td><label for="group_name">Group name</label></td>
                        <td><input type="text" name="group_name" id="" value="" /></td></tr>

                        <tr class="highlight1"><td><label for="condor_central_manager">Condor Central Manager</label></td>
                        <td><input type="text" name="condor_central_manager" id="" value="" /></td></tr>

                        <!--
                        <tr><td><label for="group_yaml">Group yaml</label></td>
                        <td><textarea name="group_yaml" rows="10" cols="30">Enter yaml here</textarea></td></tr>
                        -->


                        <tr class="highlight2"><td><label for="user_groups">Users</label></td>
                        <td><input id="search-{{ group.group_name }}" type="text" placeholder="User search.." onkeyup="search('{{group.group_name}}')"></td></tr>
                        <!--https://www.w3schools.com/howto/howto_js_filter_lists.asp-->

                        <tr><td></td><td class="highlight2">
                        <div class="user-list">
                        <ul id="ul-{{ group.group_name }}">
                        {% for user in groups_per_user %}
                            {{ user.group_name }}
                                <li><input type="checkbox" name="username.{{ forloop.counter }}" value="{{ user.username }}" />{{user.username }}</input></li>
                        {% endfor %}
                        </ul>
                        </div>
                        </td></tr>



                        <tr><td><input type="submit" value="Add Group" /></td></tr>

                    </table>
                </form>
            </div>
        </div>
    </div>


    {% for group in group_list %}
    <div id="delete-{{group.group_name}}" class="modalDialog">
        <div>
            <a href="#{{group.group_name}}" title="Close" class="close">X</a>
            <form name="{{group.group_name}}" action="/group/delete/" method="post">
                {% csrf_token %}
                <input type="hidden" name="group_name" id="" value="{{group.group_name}}" />
                <input type="submit" value="Delete {{group.group_name}}" />
            </form>
        </div>
    </div>
    {% endfor %}

</div>

<div class="footer"
    {% if response_code == 1 %}
        <tr><td><b>Error: {{ message }}</b></td></tr>
    {% elif message is not None %}
        <tr><td>{{ message }}</td></tr>
    {% endif %}
</div>


</body>

