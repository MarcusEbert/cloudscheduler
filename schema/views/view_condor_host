create or replace view view_condor_host as 
select
    cv.group_name,
    cloud_name,
    htcondor_fqdn,
    vmid,
    hostname,
    retire,
    terminate,
    machine
from csv2_vms as cv
left outer join csv2_groups as cg on
    cv.group_name=cg.group_name
left outer join (
    select distinct
        machine,
        condor_host
    from condor_machines
    ) as cm on
    cv.hostname=substring_index(cm.machine, '.', 1)
;
