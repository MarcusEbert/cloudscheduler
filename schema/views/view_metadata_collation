/*
** List all enabled group and group resource (cloud) metadata filenames together with
** identifying type (group/cloud) and sorted in user specified priority order.
*/
create or replace view view_metadata_collation as

/*
** Retrieve information.
*/

select

*

from (
    select

    cgr.group_name,
    cloud_name,
    "group" as type,
    priority,
    metadata_name

    from csv2_group_resources as cgr

    left outer join csv2_group_metadata as cgm
    on cgr.group_name=cgm.group_name

    where enabled=1

    union all select

    group_name,
    cloud_name,
    "cloud" as type,
    priority,
    metadata_name

    from csv2_group_resource_metadata

    where enabled=1
    ) as gacm /*group_and_cloud_metadata */

order by group_name,cloud_name,priority,metadata_name

;
