/*
** Retrieve groups/cloud summary information.
*/
create or replace view view_group_list_raw as

/*
** Retrieve all groups.
*/
select

group_name,
cloud_name,
0 as VMs,
0 as Jobs

from csv2_group_resources
group by group_name,cloud_name

/*
** Retrieve job count for each group.
*/
union select

group_name,
ifnull(cloud_name,'(queued or held)') as cloud_name,
0 as VMs,
count(global_job_id) as Jobs

from condor_jobs
group by group_name,cloud_name

/*
** Retrieve VM count for each group.
*/
union select

group_name,
cloud_name,
count(vmid) as VMs,
0 as Jobs

from csv2_vms
group by group_name,cloud_name

;
